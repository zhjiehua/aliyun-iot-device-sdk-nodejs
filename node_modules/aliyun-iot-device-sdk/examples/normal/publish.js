const Buffer = require('buffer').Buffer;
const util = require('util');
const aliyunIot = require('../../');
const fixtures = require('../../test/fixtures');


const device = aliyunIot.device({
...fixtures.aliyunDevice1
});

device.subscribe(`${device.productKey}/${device.deviceName}/user/get`);
device.on('message', (topic, payload) => {
    console.log(topic, payload.toString());
    device.end();
});



device.on('connect', () => {
    setTimeout (()=>{
        device.publish(`/${device.productKey}/${device.deviceName}/user/update`, 'aaa');
    },1000);
});